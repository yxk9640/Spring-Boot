{
  "version": 3,
  "sources": ["src/index.ts"],
  "sourcesContent": ["import Plugin from '@hilla/generator-typescript-core/Plugin.js';\nimport type SharedStorage from '@hilla/generator-typescript-core/SharedStorage.js';\nimport type { OpenAPIV3 } from 'openapi-types';\nimport type { ReadonlyDeep } from 'type-fest';\nimport type { SourceFile } from 'typescript';\nimport { EntityModelProcessor } from './EntityModelProcessor.js';\nimport type { Context } from './utils.js';\n\nexport enum ModelPluginSourceType {\n  Model = 'model',\n}\n\nexport default class ModelPlugin extends Plugin {\n  static readonly MODEL_PLUGIN_FILE_TAGS = 'MODEL_PLUGIN_FILE_TAGS';\n  declare ['constructor']: typeof ModelPlugin;\n  readonly #tags = new WeakMap<SourceFile, ModelPluginSourceType>();\n\n  override get path(): string {\n    return import.meta.url;\n  }\n\n  // eslint-disable-next-line @typescript-eslint/require-await\n  override async execute(storage: SharedStorage): Promise<void> {\n    const files = this.#processEntities(storage.api.components?.schemas);\n    files.forEach((file) => this.#tags.set(file, ModelPluginSourceType.Model));\n    storage.sources.push(...files);\n    storage.pluginStorage.set(this.constructor.MODEL_PLUGIN_FILE_TAGS, this.#tags);\n  }\n\n  #processEntities(schemas: ReadonlyDeep<OpenAPIV3.ComponentsObject>['schemas'] | undefined): readonly SourceFile[] {\n    this.logger.debug('Processing entities');\n\n    if (!schemas) {\n      return [];\n    }\n\n    const ctx: Context = {\n      owner: this,\n    };\n\n    return Object.entries(schemas).map(([name, component]) => EntityModelProcessor.process(name, component, ctx));\n  }\n}\n"],
  "mappings": "AAAA,OAAO,YAAY;AAKnB,SAAS,4BAA4B;AAG9B,IAAK,wBAAL,kBAAKA,2BAAL;AACL,EAAAA,uBAAA,WAAQ;AADE,SAAAA;AAAA,GAAA;AAIZ,MAAO,oBAAkC,OAAO;AAAA,EAC9C,OAAgB,yBAAyB;AAAA,EAEhC,QAAQ,oBAAI,QAA2C;AAAA,EAEhE,IAAa,OAAe;AAC1B,WAAO,YAAY;AAAA,EACrB;AAAA;AAAA,EAGA,MAAe,QAAQ,SAAuC;AAC5D,UAAM,QAAQ,KAAK,iBAAiB,QAAQ,IAAI,YAAY,OAAO;AACnE,UAAM,QAAQ,CAAC,SAAS,KAAK,MAAM,IAAI,MAAM,mBAA2B,CAAC;AACzE,YAAQ,QAAQ,KAAK,GAAG,KAAK;AAC7B,YAAQ,cAAc,IAAI,KAAK,YAAY,wBAAwB,KAAK,KAAK;AAAA,EAC/E;AAAA,EAEA,iBAAiB,SAAiG;AAChH,SAAK,OAAO,MAAM,qBAAqB;AAEvC,QAAI,CAAC,SAAS;AACZ,aAAO,CAAC;AAAA,IACV;AAEA,UAAM,MAAe;AAAA,MACnB,OAAO;AAAA,IACT;AAEA,WAAO,OAAO,QAAQ,OAAO,EAAE,IAAI,CAAC,CAAC,MAAM,SAAS,MAAM,qBAAqB,QAAQ,MAAM,WAAW,GAAG,CAAC;AAAA,EAC9G;AACF;",
  "names": ["ModelPluginSourceType"]
}
