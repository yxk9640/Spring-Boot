{
  "version": 3,
  "sources": ["src/BarrelProcessor.ts"],
  "sourcesContent": ["import { basename, dirname } from 'path';\nimport type Plugin from '@hilla/generator-typescript-core/Plugin.js';\nimport createSourceFile from '@hilla/generator-typescript-utils/createSourceFile.js';\nimport DependencyManager from '@hilla/generator-typescript-utils/dependencies/DependencyManager.js';\nimport PathManager from '@hilla/generator-typescript-utils/dependencies/PathManager.js';\nimport type { SourceFile } from 'typescript';\n\nexport default class BarrelProcessor {\n  static readonly BARREL_FILE_NAME = 'endpoints.ts';\n  declare ['constructor']: typeof BarrelProcessor;\n  readonly #endpoints: readonly SourceFile[];\n  readonly #outputPathManager = new PathManager({ extension: 'ts' });\n  readonly #owner: Plugin;\n\n  constructor(endpoints: readonly SourceFile[], owner: Plugin) {\n    this.#endpoints = endpoints;\n    this.#owner = owner;\n  }\n\n  process(): SourceFile {\n    this.#owner.logger.debug(`Generating '${this.constructor.BARREL_FILE_NAME}' file`);\n\n    const { exports, imports } = this.#endpoints.reduce(\n      (acc, { fileName }) => {\n        const specifier = basename(fileName, '.ts');\n        const path = `${dirname(fileName)}/${specifier}`;\n\n        const id = acc.imports.namespace.add(acc.paths.createRelativePath(path), specifier);\n        acc.exports.named.add(specifier, false, id);\n\n        return acc;\n      },\n      new DependencyManager(new PathManager({ extension: '.js' })),\n    );\n\n    return createSourceFile(\n      [...imports.toCode(), ...exports.toCode()],\n      this.#outputPathManager.createRelativePath('endpoints'),\n    );\n  }\n}\n"],
  "mappings": "AAAA,SAAS,UAAU,eAAe;AAElC,OAAO,sBAAsB;AAC7B,OAAO,uBAAuB;AAC9B,OAAO,iBAAiB;AAGxB,MAAO,gBAA8B;AAAA,EACnC,OAAgB,mBAAmB;AAAA,EAE1B;AAAA,EACA,qBAAqB,IAAI,YAAY,EAAE,WAAW,KAAK,CAAC;AAAA,EACxD;AAAA,EAET,YAAY,WAAkC,OAAe;AAC3D,SAAK,aAAa;AAClB,SAAK,SAAS;AAAA,EAChB;AAAA,EAEA,UAAsB;AACpB,SAAK,OAAO,OAAO,MAAM,eAAe,KAAK,YAAY,gBAAgB,QAAQ;AAEjF,UAAM,EAAE,SAAS,QAAQ,IAAI,KAAK,WAAW;AAAA,MAC3C,CAAC,KAAK,EAAE,SAAS,MAAM;AACrB,cAAM,YAAY,SAAS,UAAU,KAAK;AAC1C,cAAM,OAAO,GAAG,QAAQ,QAAQ,CAAC,IAAI,SAAS;AAE9C,cAAM,KAAK,IAAI,QAAQ,UAAU,IAAI,IAAI,MAAM,mBAAmB,IAAI,GAAG,SAAS;AAClF,YAAI,QAAQ,MAAM,IAAI,WAAW,OAAO,EAAE;AAE1C,eAAO;AAAA,MACT;AAAA,MACA,IAAI,kBAAkB,IAAI,YAAY,EAAE,WAAW,MAAM,CAAC,CAAC;AAAA,IAC7D;AAEA,WAAO;AAAA,MACL,CAAC,GAAG,QAAQ,OAAO,GAAG,GAAG,QAAQ,OAAO,CAAC;AAAA,MACzC,KAAK,mBAAmB,mBAAmB,WAAW;AAAA,IACxD;AAAA,EACF;AACF;",
  "names": []
}
